  slave_servers {
<%-
require 'net/http'
require 'json'
http     = Net::HTTP.new(@puppetdb_server, @puppetdb_port)
request  = Net::HTTP::Get.new('/pdb/query/v4/resources/Knot::Remote')
begin
  response = http.request(request)
  if response.code != 200
    scope.call_function(
      'warning',
      ["unable to connect to the puppet server, exported resources wont work: #{response.code}"])
  end
  response_json = JSON.parse(response.body)
  slave_resources = response_json.collect do |resource|
    if resource['certname'] == @fqdn && resource['title'] =~ /dns__export_.+/
      resource
    end
  end
  slave_resources.compact!
  slave_resources.each_with_index do |slave, index|
    last = slave_resources.size - 1 == index
    ipv4_address = slave['parameters'].include?('address4')
    ipv6_address = slave['parameters'].include?('address6')
    if ipv4_address
-%>
    <%= slave['title'] %>-ipv4<%- if ! last || ipv6_address -%>,<%- end %>
<%-
    end
    if ipv6_address
-%>
    <%= slave['title'] %>-ipv6<%- if ! last -%>,<%- end %>
<%-
    end
  end
rescue Exception => e
  scope.call_function('warning', ["unable to connect to the puppetdb server, exported resources wont work: #{e}"])
end
-%>
  }
}
