remotes {
<%- @masters.each_with_index do |master, index| -%>
  xfr-in-<%= @name %><%= index + 1 %> {
    address <%= master %>; 
    port 53;
    <%- if @tsig then -%>
    key <%= @tsig['name'] %>;
    <%- end -%>
  }
<%- end -%>
<%- @provide_xfr.each_with_index do |xfr, index| -%>
  xfr-out-<%= @name %><%= index + 1 %> {
    address <%= xfr %>;
    port 53;
  }
<%- end -%>
<%- @notify_addresses.each_with_index do |notify_address, index| -%>
  notify-out-<%= @name %><%= index + 1 %> {
    address <%= notify_address %>;
    port 53;
  }
<%- end -%>
<%- @allow_notify.each_with_index do |notify, index| -%>
  notify-in-<%= @name %><%= index + 1 %> {
    address <%= notify %>;
    port 53;
  }
<%- end -%>
}
groups {
  xfr-in-<%= @name %> {
<%- @masters.each_with_index do |master, index| -%>
    xfr-in-<%= @name %><%= index + 1 %><% if index + 1 < @masters.length then %>,<%- end %>
<%- end -%>
  }
  xfr-out-<%= @name %> {
<%- @provide_xfr.each_with_index do |xfr, index| -%>
    xfr-out-<%= @name %><%= index + 1 %><% if index + 1 < @provide_xfr.length then %>,<%- end -%>
<%- end %>
  }
  notify-out-<%= @name %> {
<%- @notify_addresses.each_with_index do |notify_address, index| -%>
    notify-out-<%= @name %><%= index + 1 %><% if index + 1 < @notify_addresses.length then %>,<%- end -%>
<%- end %>
  }
  notify-in-<%= @name %> {
<%- @allow_notify.each_with_index do |notify, index| -%>
    notify-in-<%= @name %><%= index + 1 %><% if index + 1 < @allow_notify.length then %>,<%- end %>
<%- end -%>
  }
}
zones {
  <%- @zones.each do |zone| -%>
    "<%= zone %>" {
      <%- if @zonefile then -%>
        file "<%= @zone_subdir %>/<%= @zonefile %>";
      <%- else -%>
        file "<%= @zone_subdir %>/<%= zone %>";
      <%- end -%>
      <%- if @notify_addresses.any? then -%>
        notify-out notify-out-<%= @name %>, global-slaves;
      <%- end -%>
      <%- if @allow_notify.any? then -%>
        notify-in notify-in-<%= @name %>;
      <%- end -%>
      <%- if @masters.any? then -%>
        xfr-in xfr-in-<%= @name %>;
      <%- end -%>
      <%- if @provide_xfr.any? then -%>
        xfr-out xfr-out-<%= @name %>, global-slaves;
      <%- end -%>
    }
  <%- end -%>
}
